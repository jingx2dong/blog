<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Python小记 | Jing の Blog</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/blog/img/favicon.png">
    <meta name="description" content="锦衣夜行 の 夜无知者">
    <link rel="preload" href="/blog/assets/css/0.styles.5608eb1c.css" as="style"><link rel="preload" href="/blog/assets/js/app.489ad0c2.js" as="script"><link rel="preload" href="/blog/assets/js/2.0ae801dd.js" as="script"><link rel="preload" href="/blog/assets/js/11.d901ca5a.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.009d75fa.js"><link rel="prefetch" href="/blog/assets/js/3.54d3a012.js"><link rel="prefetch" href="/blog/assets/js/4.1cfc2f80.js"><link rel="prefetch" href="/blog/assets/js/5.95534bab.js"><link rel="prefetch" href="/blog/assets/js/6.b53fe78c.js"><link rel="prefetch" href="/blog/assets/js/7.2cb49d30.js"><link rel="prefetch" href="/blog/assets/js/8.b37edb03.js"><link rel="prefetch" href="/blog/assets/js/9.f2fad4d2.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.5608eb1c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Jing の Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/dreaming/" class="nav-link">
  只争朝夕
</a></div><div class="nav-item"><a href="/blog/living/" class="nav-link">
  蜉蝣天地
</a></div><div class="nav-item"><a href="/blog/work/" class="nav-link router-link-active">
  摸鱼
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/dreaming/" class="nav-link">
  只争朝夕
</a></div><div class="nav-item"><a href="/blog/living/" class="nav-link">
  蜉蝣天地
</a></div><div class="nav-item"><a href="/blog/work/" class="nav-link router-link-active">
  摸鱼
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>1. 事件热点</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/work/case/agora.html" aria-current="page" class="active sidebar-link">Python小记</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/work/case/agora.html#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/blog/work/case/agora.html#思路" class="sidebar-link">思路</a></li><li class="sidebar-sub-header"><a href="/blog/work/case/agora.html#选型" class="sidebar-link">选型</a></li><li class="sidebar-sub-header"><a href="/blog/work/case/agora.html#收获" class="sidebar-link">收获</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>2. 职场感冒</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="python小记"><a href="#python小记" class="header-anchor">#</a> Python小记</h1> <p>没想到作为一个Javaer，第一次工作笔记献给了Python~</p> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>  之前有一个问题，供应商提供的方案需要申请一台服务器，则涉及每年一万多元的硬件费用以及一万多的开发费用。钱是不多，但是这样系统架构不太合理，工作中一个重要的原则是，尽量减少依赖、减少复杂度，如此涉及对于后续的维护和扩展都存有隐患。</p> <h2 id="思路"><a href="#思路" class="header-anchor">#</a> 思路</h2> <p>  可以通过修改Nginx的配置文件来实现内网环境下的要求，但是对于VPN情况下，又需要改为另外一个配置。则就需要动态的进行Nginx设置变更。那么就可以通过一个URL请求来触发Nginx的设置变更。<br>
  那么整体思路如下：</p> <ol><li>复制两个Nginx文件，分别命名N1.conf N2.conf</li> <li>开发两个脚本Shell分别为S1、S2，分别是复制N1.conf/N2.conf 覆盖nginx.conf，然后执行nginx的reload操作；</li> <li>开发一个简单的后端，两个URL，分别执行S1，S2</li> <li>VPN环境下，调用URL1，切换S1配置；内网调用URL2，再切换为S2；绝大部分情况都使用S2即可，这样的代价已经很小了。</li></ol> <h2 id="选型"><a href="#选型" class="header-anchor">#</a> 选型</h2> <p>  即然作为Javaer，第一时间想到Java来实现。但简单调研后，觉得Java有三个问题，并不适合：</p> <ol><li>目前系统没有安装JDK/JRE需要安装并配置相关环境</li> <li>Java执行Shell命令需要使用getRuntime得到Process再执行，效率很低</li> <li>占用内存太多，有点拿大炮打蚊子的感觉。</li></ol> <p>  很快想到用GO或者Python来实现，看来一下<code>Python -Version</code>系统中果然已经安装了Python。那就决定用Python来实现了。<br>
  百度一下用VS Code来写了一个简单的后台，代码也就一行，执行Shell脚本-S1 S2。</p> <h2 id="收获"><a href="#收获" class="header-anchor">#</a> 收获</h2> <ul><li>Python的Hello Wold，也算是实战过了~😂😂</li> <li>cp 命令不能强制覆盖，就算cp -f src tgt也不行，只能/cp 。因为一般cp都通过alias来重写了</li> <li>Python通过flask来开发web应用服务，以及相关的route写法</li> <li>Python语法<div class="language-python line-numbers-mode"><pre class="language-python"><code>  <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span><span class="token operator">//</span>说明可以当作主程序允许
  app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">1234</span><span class="token punctuation">)</span><span class="token operator">//</span>可以被任意ip访问，指定端口
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li>花了一个周末完全搞定，周一测试交业务测试；得到认可，使用方便而且节省了一小笔费用，灰常开心~😊</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/14/2020, 3:59:35 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.489ad0c2.js" defer></script><script src="/blog/assets/js/2.0ae801dd.js" defer></script><script src="/blog/assets/js/11.d901ca5a.js" defer></script>
  </body>
</html>
